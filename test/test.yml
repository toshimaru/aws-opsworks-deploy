version: "2.1"

orbs:
  aws-cli: circleci/aws-cli@0.1.4

jobs:
  build:
    executor: aws-cli/default
    environment:
      # These environment variables are required for aws-cli
      AWS_ACCESS_KEY_ID: test_key
      AWS_SECRET_ACCESS_KEY: test_secret
      AWS_REGION: ap-northeast-1
    steps:
      - checkout
      - aws-cli/install
      - aws-cli/configure
      # test orb command
      - aws-opsworks-deploy/deploy:
          stack-id: dummy_stack_id
          app-id: dummy_app_id
          # Set generate-cli-skeleton option true to avoid test failed.
          generate-cli-skeleton: true 
